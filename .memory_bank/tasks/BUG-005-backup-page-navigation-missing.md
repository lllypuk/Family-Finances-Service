# BUG-005: Пропадает навигация пользователя на странице бэкапов

## Приоритет: СРЕДНИЙ (UI/UX)

## Описание проблемы

На странице `/admin/backup` в навигации отображается "Вход" и "Регистрация" вместо имени авторизованного пользователя и
выпадающего меню.

## Воспроизведение

1. Войти в систему как администратор
2. Перейти на любую страницу (например, дашборд) - видим "Тест Тестов" в навигации
3. Перейти на страницу бэкапов (`/admin/backup`)
4. В навигации отображается "Вход" и "Регистрация" вместо имени пользователя

## Анализ

Шаблон страницы бэкапов не получает данные пользователя для отображения в навигации. Возможные причины:

1. В handler не передаётся информация о пользователе в шаблон
2. Шаблон использует другой layout без проверки авторизации
3. Данные сессии не читаются корректно в этом handler

## Локация бага

- **Handler**: `internal/web/handlers/backup.go` -> `BackupPage`
- **Шаблон**: `internal/web/templates/admin/backup.html`
- **Layout**: `internal/web/templates/layouts/` (проверить какой используется)

## Задачи по исправлению

1. [ ] Проверить handler `BackupPage` - передаёт ли он User в шаблон
2. [ ] Сравнить с другими handlers, которые корректно отображают навигацию
3. [ ] Убедиться, что шаблон backup использует правильный layout
4. [ ] Добавить передачу данных пользователя в контекст шаблона
5. [ ] Протестировать через agent-browser
6. [ ] Запустить `make lint` и `make test`

## Пример корректной передачи данных

```go
func (h *BackupHandler) BackupPage(c echo.Context) error {
user := getUserFromContext(c) // или из сессии

return c.Render(http.StatusOK, "admin/backup.html", map[string]interface{}{
"User":      user,
"CSRFToken": c.Get("csrf_token"),
// ... другие данные
})
}
```

## Связанные файлы

- `internal/web/handlers/backup.go`
- `internal/web/templates/admin/backup.html`
- `internal/web/templates/layouts/main.html` (или base.html)
- `internal/web/templates/components/nav.html`

## Связь с BUG-003

Эта проблема может быть связана с BUG-003 (403 при создании бэкапа). Если навигация не отображает пользователя, возможно
сессия не читается корректно, что также может вызывать 403 ошибку.

**Рекомендация**: Исправлять вместе с BUG-003.

## Критерии приёмки

- [ ] На странице backup отображается имя авторизованного пользователя
- [ ] Выпадающее меню пользователя работает
- [ ] Навигация идентична другим страницам
- [ ] Протестировано через agent-browser
- [ ] Линтер не выдаёт ошибок

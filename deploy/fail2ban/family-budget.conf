# Fail2ban filter for Family Budget Service
# /etc/fail2ban/filter.d/family-budget.conf

[Definition]

# Failed login attempts - match various authentication failure patterns
failregex = ^<HOST> - .* "POST /login HTTP.*" 401 .*$
            ^<HOST> - .* "POST /api/v1/auth/login HTTP.*" 401 .*$
            ^.*authentication failed.*client=<HOST>.*$
            ^.*invalid password.*client=<HOST>.*$
            ^.*invalid credentials.*client=<HOST>.*$
            ^.*login failed.*client=<HOST>.*$

# Ignore successful logins (200 OK, 302 Redirect)
ignoreregex = ^<HOST> - .* "POST /login HTTP.*" 200 .*$
              ^<HOST> - .* "POST /login HTTP.*" 302 .*$

# Date pattern (if needed for custom log format)
datepattern = {^LN-BEG}%%ExY(?P<_sep>[-/.])%%m(?P=_sep)%%d[T ]%%H:%%M:%%S(?:[.,]%%f)?(?:\s*%%z)?
